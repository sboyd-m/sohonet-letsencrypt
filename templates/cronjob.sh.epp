<%- | String $virtualenv_path,
      String $site_fqdn,
      String $pre_hook = '/usr/bin/env true',
      String $post_hook = '/usr/bin/env true',
| -%>
#!/bin/sh
# Managed by Puppet.

cd "<%= $virtualenv_path %>" || exit 1

/usr/bin/env pipenv run certbot \
    -c "<%= $virtualenv_path %>/config.ini" \
    --keep-until-expiring \
    --quiet \
    renew \
    --cert-name "<%= $site_fqdn %>" \
    --pre-hook "<%= $pre_hook %>" \
    --post-hook "<%= $post_hook %>"
